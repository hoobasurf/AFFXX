<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Choisis ta salle ‚Äì Affinix</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      padding: 2rem;
      text-align: center;
    }
    h1 {
      margin-bottom: 2rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1.5rem;
      max-width: 800px;
      margin: 0 auto;
    }
    .panel {
      background: #222;
      border-radius: 12px;
      padding: 1.5rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      box-shadow: 0 0 5px #0ff;
      font-size: 1.1rem;
      user-select: none;
    }
    .panel:hover {
      background-color: #0ff;
      color: #000;
      box-shadow: 0 0 15px #0ff;
    }
    .btn-deco {
      margin-top: 2rem;
      background-color: #f00;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.3s;
    }
    .btn-deco:hover {
      background-color: #c00;
    }
  </style>
</head>
<body>

  <h1>Bienvenue dans les salles Affinix</h1>
  <div class="grid" id="panel-container">
    <!-- Les salles coch√©es s'affichent ici -->
  </div>

  <button class="btn-deco" id="logout-btn">D√©connexion</button>

  <script type="module">
    import { auth, db } from './js/firebase-init.js';
    import { signOut, onAuthStateChanged } from 'firebase/auth';
    import { doc, getDoc } from 'firebase/firestore';

    const container = document.getElementById('panel-container');

    const panels = {
      salle1: { label: "üí¨ Rencontre Amicale", href: "salle1.html" },
      salle2: { label: "üíñ Relation S√©rieuse", href: "salle2.html" },
      salle3: { label: "üéâ Rencontre Fun", href: "salle3.html" },
      salle4: { label: "üë®‚Äçüë©‚Äçüëß Parents Solos", href: "salle4.html" },
      salle5: { label: "üéÆ Univers Passions", href: "salle5.html" },
      salle6: { label: "üß¨ Connexion Unique", href: "salle6.html" }
    };

    onAuthStateChanged(auth, async user => {
      if (!user) {
        window.location.href = "connexion.html";
        return;
      }

      const userDoc = await getDoc(doc(db, "users", user.uid));
      const userData = userDoc.data();

      if (!userData || !userData.salles) {
        container.innerHTML = "<p>Aucune salle s√©lectionn√©e.</p>";
        return;
      }

      // Afficher les salles coch√©es
      userData.salles.forEach(salleKey => {
        if (panels[salleKey]) {
          const div = document.createElement("div");
          div.className = "panel";
          div.textContent = panels[salleKey].label;
          div.onclick = () => location.href = panels[salleKey].href;
          container.appendChild(div);
        }
      });

      // Salle sp√©ciale : Le Cr√©ateur (toujours visible)
      const createur = document.createElement("div");
      createur.className = "panel";
      createur.textContent = "üí° Le Cr√©ateur";
      createur.onclick = () => location.href = "createur.html";
      container.appendChild(createur);
    });

    // D√©connexion
    document.getElementById("logout-btn").addEventListener("click", async () => {
      await signOut(auth);
      window.location.href = "connexion.html";
    });
  </script>

</body>
</html>
