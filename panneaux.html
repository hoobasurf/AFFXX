<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Choisis ta salle ‚Äì Affinix</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      padding: 2rem;
      text-align: center;
    }
    h1 {
      margin-bottom: 2rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1.5rem;
      max-width: 800px;
      margin: 0 auto;
    }
    .panel {
      background: #222;
      border-radius: 12px;
      padding: 1.5rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      box-shadow: 0 0 5px #0ff;
      font-size: 1.1rem;
      user-select: none;
    }
    .panel:hover {
      background-color: #0ff;
      color: #000;
      box-shadow: 0 0 15px #0ff;
    }

    .logout {
      margin-top: 2rem;
    }
    .logout button {
      background: #f00;
      color: #fff;
      border: none;
      padding: 10px 20px;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 0 10px #f00;
      transition: background 0.3s ease;
    }
    .logout button:hover {
      background: #c00;
    }
  </style>
</head>
<body>

  <h1>Bienvenue dans les salles Affinix</h1>

  <div class="grid" id="sallesContainer">
    <!-- Les salles coch√©es lors de l'inscription appara√Ætront ici dynamiquement -->
  </div>

  <div class="logout">
    <button id="logoutBtn">D√©connexion</button>
  </div>

  <script type="module">
    import { auth } from './js/firebase-init.js';
    import { signOut, onAuthStateChanged } from "firebase/auth";

    // Liste des salles (avec cl√© et label)
    const salles = {
      salle1: "üí¨ Rencontre Amicale",
      salle2: "üíñ Relation S√©rieuse",
      salle3: "üéâ Rencontre Fun",
      salle4: "üë®‚Äçüë©‚Äçüëß Parents Solos",
      salle5: "üéÆ Univers Passions",
      salle6: "üß¨ Connexion Unique"
    };

    // V√©rifie si l'utilisateur est connect√©
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "connexion.html";
      } else {
        // R√©cup√®re les salles choisies dans localStorage
        const data = JSON.parse(localStorage.getItem("userSalles"));
        const container = document.getElementById("sallesContainer");

        if (data) {
          Object.keys(salles).forEach(key => {
            if (data.includes(key)) {
              const div = document.createElement("div");
              div.className = "panel";
              div.textContent = salles[key];
              div.onclick = () => window.location.href = key + ".html";
              container.appendChild(div);
            }
          });
        } else {
          container.innerHTML = "<p>Aucune salle s√©lectionn√©e. Merci de vous r√©inscrire.</p>";
        }
      }
    });

    // Bouton d√©connexion
    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await signOut(auth);
      window.location.href = "index.html";
    });
  </script>

</body>
</html>
